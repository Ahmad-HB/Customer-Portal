using System;
using System.Collections.Generic;
using System.Threading.Tasks;
using Customer.Portal.Entities;
using Customer.Portal.Enums;
using Volo.Abp.Data;
using Volo.Abp.DependencyInjection;
using Volo.Abp.Domain.Repositories;
using Volo.Abp.Guids;

namespace Customer.Portal.DbMigrator.DataSeeders;

public class ReportTemplateDataSeedContributor : IDataSeedContributor, ITransientDependency
{
    #region Fields

    private readonly IRepository<ReportTemplate, Guid> _reportTemplateRepository;
    private readonly IGuidGenerator _guidGenerator;

    #endregion


    #region Ctor

    public ReportTemplateDataSeedContributor(IGuidGenerator guidGenerator,
        IRepository<ReportTemplate, Guid> reportTemplateRepository)
    {
        _guidGenerator = guidGenerator;
        _reportTemplateRepository = reportTemplateRepository;
    }

    #endregion


    public async Task SeedAsync(DataSeedContext context)
    {
        if (await _reportTemplateRepository.GetCountAsync() > 0)
        {
            return;
        }
        var reportTemplatelist = new List<ReportTemplate>
        {
            new ReportTemplate(
                _guidGenerator.Create(),
                TemplateType.Report,
                ReportTypes.SummaryReport,
                "Summary Report",
                "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Summary Report</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            line-height: 1.5;\n            color: #2c3e50;\n            background: white;\n            margin: 0;\n            padding: 0;\n        }\n\n        .container {\n            max-width: 1000px;\n            margin: 0 auto;\n            background: white;\n            border: 1px solid #e9ecef;\n            overflow: hidden;\n        }\n\n        .header {\n            background: #2c3e50;\n            color: white;\n            padding: 30px;\n            text-align: center;\n            border-bottom: 4px solid #1a252f;\n            position: relative;\n        }\n\n        .header::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            right: 0;\n            width: 100px;\n            height: 100px;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 50%;\n            transform: translate(30px, -30px);\n        }\n\n        .header h1 {\n            font-size: 2.8rem;\n            font-weight: 800;\n            margin: 0 0 12px 0;\n            letter-spacing: 1px;\n            position: relative;\n        }\n\n        .header .subtitle {\n            font-size: 1.2rem;\n            opacity: 0.9;\n            font-weight: 300;\n            margin: 0;\n            letter-spacing: 0.5px;\n            position: relative;\n        }\n\n        .content {\n            padding: 30px;\n            background: #ffffff;\n        }\n\n        .period-section {\n            background: #3498db;\n            color: white;\n            padding: 25px;\n            margin-bottom: 25px;\n            text-align: center;\n            position: relative;\n        }\n\n        .period-section::before {\n            content: '';\n            position: absolute;\n            top: 10px;\n            right: 10px;\n            width: 50px;\n            height: 50px;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 50%;\n        }\n\n        .period-section h2 {\n            font-size: 1.6rem;\n            margin-bottom: 20px;\n            font-weight: 700;\n            letter-spacing: 0.5px;\n            position: relative;\n        }\n\n        .period-dates {\n            display: flex;\n            justify-content: center;\n            gap: 30px;\n            flex-wrap: wrap;\n            position: relative;\n        }\n\n        .date-item {\n            background: rgba(255, 255, 255, 0.2);\n            padding: 18px 30px;\n        }\n\n        .date-item strong {\n            display: block;\n            font-size: 0.95rem;\n            margin-bottom: 8px;\n            opacity: 0.9;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n\n        .date-item span {\n            font-size: 1.3rem;\n            font-weight: 800;\n        }\n\n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 25px;\n            margin-bottom: 35px;\n        }\n\n        .metric-card {\n            background: white;\n            padding: 25px;\n            text-align: center;\n            border: 1px solid #e9ecef;\n            position: relative;\n            overflow: hidden;\n        }\n\n        .metric-card::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            height: 5px;\n            background: #3498db;\n        }\n\n        .metric-icon {\n            font-size: 2.5rem;\n            margin-bottom: 15px;\n            display: block;\n        }\n\n        .metric-value {\n            font-size: 2.8rem;\n            font-weight: 800;\n            color: #2c3e50;\n            margin-bottom: 10px;\n            line-height: 1;\n        }\n\n        .metric-label {\n            font-size: 0.95rem;\n            color: #7f8c8d;\n            font-weight: 700;\n            text-transform: uppercase;\n            letter-spacing: 1px;\n        }\n\n        .progress-bar {\n            height: 8px;\n            background: #e9ecef;\n            border-radius: 4px;\n            overflow: hidden;\n            margin-top: 10px;\n        }\n\n        .progress-fill {\n            height: 100%;\n            background: #3498db;\n            border-radius: 4px;\n        }\n\n        .chart-section {\n            background: #f8f9fa;\n            padding: 30px;\n            margin-bottom: 25px;\n            border: 1px solid #e9ecef;\n        }\n\n        .chart-section h2 {\n            color: #2c3e50;\n            font-size: 1.7rem;\n            margin-bottom: 25px;\n            text-align: center;\n            font-weight: 700;\n            border-bottom: 3px solid #3498db;\n            padding-bottom: 15px;\n            letter-spacing: 0.5px;\n        }\n\n        .chart-visual {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n            gap: 20px;\n            margin-top: 20px;\n        }\n\n        .chart-item {\n            background: white;\n            padding: 20px;\n            text-align: center;\n            border: 1px solid #e9ecef;\n            position: relative;\n        }\n\n        .chart-item::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            height: 4px;\n            border-radius: 4px 4px 0 0;\n        }\n\n        .chart-item.resolved::before { background: #2ecc71; }\n        .chart-item.in-progress::before { background: #3498db; }\n        .chart-item.closed::before { background: #9b59b6; }\n        .chart-item.other::before { background: #e74c3c; }\n\n        .chart-item .chart-icon {\n            font-size: 2rem;\n            margin-bottom: 10px;\n            display: block;\n        }\n\n        .chart-item .chart-value {\n            font-size: 1.8rem;\n            font-weight: 800;\n            color: #2c3e50;\n            margin-bottom: 5px;\n        }\n\n        .chart-item .chart-label {\n            font-size: 0.9rem;\n            color: #7f8c8d;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n\n        .stats-section {\n            background: #f8f9fa;\n            padding: 30px;\n            margin-bottom: 25px;\n            border: 1px solid #e9ecef;\n        }\n\n        .stats-section h2 {\n            color: #2c3e50;\n            font-size: 1.7rem;\n            margin-bottom: 25px;\n            text-align: center;\n            font-weight: 700;\n            border-bottom: 3px solid #3498db;\n            padding-bottom: 15px;\n            letter-spacing: 0.5px;\n        }\n\n        .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n        }\n\n        .stat-item {\n            background: white;\n            padding: 22px;\n            border: 1px solid #e9ecef;\n            border-left: 5px solid #3498db;\n        }\n\n        .stat-item strong {\n            color: #3498db;\n            display: block;\n            font-size: 0.9rem;\n            margin-bottom: 10px;\n            text-transform: uppercase;\n            letter-spacing: 0.8px;\n            font-weight: 700;\n        }\n\n        .stat-item .value {\n            font-size: 1.8rem;\n            font-weight: 800;\n            color: #2c3e50;\n        }\n\n        .performance-section {\n            background: #e67e22;\n            color: white;\n            padding: 30px;\n            text-align: center;\n            position: relative;\n        }\n\n        .performance-section::before {\n            content: '';\n            position: absolute;\n            top: 10px;\n            left: 10px;\n            width: 50px;\n            height: 50px;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 50%;\n        }\n\n        .performance-section h2 {\n            font-size: 1.7rem;\n            margin-bottom: 20px;\n            font-weight: 700;\n            letter-spacing: 0.5px;\n            position: relative;\n        }\n\n        .performance-text {\n            font-size: 1.1rem;\n            line-height: 1.7;\n            opacity: 0.95;\n            max-width: 700px;\n            margin: 0 auto;\n            font-weight: 400;\n            position: relative;\n        }\n\n        .footer {\n            background: #2c3e50;\n            color: white;\n            padding: 20px;\n            text-align: center;\n            font-size: 0.95rem;\n            border-top: 4px solid #1a252f;\n        }\n\n        .footer p {\n            margin-bottom: 5px;\n        }\n\n        .footer .copyright {\n            opacity: 0.9;\n            font-weight: 600;\n            letter-spacing: 0.5px;\n        }\n\n        .footer .generated {\n            opacity: 0.8;\n            font-size: 0.9rem;\n            font-weight: 400;\n        }\n\n        /* Responsive Design */\n        @media (max-width: 768px) {\n            .header h1 {\n                font-size: 1.8rem;\n            }\n            \n            .period-dates {\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .metrics-grid {\n                grid-template-columns: 1fr;\n            }\n            \n            .stats-grid {\n                grid-template-columns: 1fr;\n            }\n            \n            .content {\n                padding: 20px;\n            }\n        }\n\n        /* Print Styles */\n        @media print {\n            * {\n                -webkit-print-color-adjust: exact !important;\n                color-adjust: exact !important;\n                print-color-adjust: exact !important;\n            }\n            \n            body {\n                background: white !important;\n                padding: 0;\n                margin: 0;\n            }\n            \n            .container {\n                box-shadow: none !important;\n                border-radius: 0 !important;\n                border: none !important;\n                margin: 0 !important;\n                max-width: none !important;\n            }\n            \n            .header, .period-section, .performance-section, .footer {\n                -webkit-print-color-adjust: exact !important;\n                color-adjust: exact !important;\n                print-color-adjust: exact !important;\n            }\n            \n            .metric-card, .stat-item, .chart-item {\n                break-inside: avoid;\n                page-break-inside: avoid;\n            }\n        }\n        \n        /* PDF-specific optimizations */\n        @page {\n            margin: 0.5in;\n            size: A4;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>\ud83d\udcca Summary Report</h1>\n            <div class=\"subtitle\">Executive Dashboard & Analytics</div>\n        </div>\n        \n        <div class=\"content\">\n            <div class=\"period-section\">\n                <h2>\ud83d\udcc5 Report Period</h2>\n                <div class=\"period-dates\">\n                    <div class=\"date-item\">\n                        <strong>Start Date</strong>\n                        <span>{{ start_date }}</span>\n                    </div>\n                    <div class=\"date-item\">\n                        <strong>End Date</strong>\n                        <span>{{ end_date }}</span>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"metrics-grid\">\n                <div class=\"metric-card\">\n                    <div class=\"metric-icon\">\ud83c\udfab</div>\n                    <div class=\"metric-value\">{{ total_tickets }}</div>\n                    <div class=\"metric-label\">Total Tickets</div>\n                </div>\n                \n                <div class=\"metric-card\">\n                    <div class=\"metric-icon\">\u2705</div>\n                    <div class=\"metric-value\">{{ resolved_tickets }}</div>\n                    <div class=\"metric-label\">Resolved</div>\n                    <div class=\"progress-bar\">\n                        <div class=\"progress-fill\" style=\"width: {{ if total_tickets > 0 }}{{ resolved_tickets / total_tickets * 100 }}{{ else }}0{{ end }}%\"></div>\n                    </div>\n                </div>\n                \n                <div class=\"metric-card\">\n                    <div class=\"metric-icon\">\ud83d\udd04</div>\n                    <div class=\"metric-value\">{{ in_progress_tickets }}</div>\n                    <div class=\"metric-label\">In Progress</div>\n                    <div class=\"progress-bar\">\n                        <div class=\"progress-fill\" style=\"width: {{ if total_tickets > 0 }}{{ in_progress_tickets / total_tickets * 100 }}{{ else }}0{{ end }}%\"></div>\n                    </div>\n                </div>\n                \n                <div class=\"metric-card\">\n                    <div class=\"metric-icon\">\ud83d\udd12</div>\n                    <div class=\"metric-value\">{{ closed_tickets }}</div>\n                    <div class=\"metric-label\">Closed</div>\n                    <div class=\"progress-bar\">\n                        <div class=\"progress-fill\" style=\"width: {{ if total_tickets > 0 }}{{ closed_tickets / total_tickets * 100 }}{{ else }}0{{ end }}%\"></div>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"chart-section\">\n                <h2>\ud83d\udcca Ticket Distribution</h2>\n                <div class=\"chart-visual\">\n                    <div class=\"chart-item resolved\">\n                        <div class=\"chart-icon\">\u2705</div>\n                        <div class=\"chart-value\">{{ resolved_tickets }}</div>\n                        <div class=\"chart-label\">Resolved</div>\n                    </div>\n                    <div class=\"chart-item in-progress\">\n                        <div class=\"chart-icon\">\ud83d\udd04</div>\n                        <div class=\"chart-value\">{{ in_progress_tickets }}</div>\n                        <div class=\"chart-label\">In Progress</div>\n                    </div>\n                    <div class=\"chart-item closed\">\n                        <div class=\"chart-icon\">\ud83d\udd12</div>\n                        <div class=\"chart-value\">{{ closed_tickets }}</div>\n                        <div class=\"chart-label\">Closed</div>\n                    </div>\n                    <div class=\"chart-item other\">\n                        <div class=\"chart-icon\">\ud83d\udccb</div>\n                        <div class=\"chart-value\">{{ total_tickets - resolved_tickets - in_progress_tickets - closed_tickets }}</div>\n                        <div class=\"chart-label\">Other</div>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"stats-section\">\n                <h2>\ud83d\udcc8 Performance Metrics</h2>\n                <div class=\"stats-grid\">\n                    <div class=\"stat-item\">\n                        <strong>Resolution Rate</strong>\n                        <div class=\"value\">\n                            {{ if total_tickets > 0 }}{{ resolved_tickets / total_tickets * 100 | math.round 1 }}{{ else }}0{{ end }}%\n                        </div>\n                    </div>\n                    \n                    <div class=\"stat-item\">\n                        <strong>Active Tickets</strong>\n                        <div class=\"value\">{{ in_progress_tickets }}</div>\n                    </div>\n                    \n                    <div class=\"stat-item\">\n                        <strong>Completed Tickets</strong>\n                        <div class=\"value\">{{ resolved_tickets + closed_tickets }}</div>\n                    </div>\n                    \n                    <div class=\"stat-item\">\n                        <strong>Completion Rate</strong>\n                        <div class=\"value\">\n                            {{ if total_tickets > 0 }}{{ (resolved_tickets + closed_tickets) / total_tickets * 100 | math.round 1 }}{{ else }}0{{ end }}%\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"performance-section\">\n                <h2>\ud83c\udfaf Performance Summary</h2>\n                <div class=\"performance-text\">\n                    This comprehensive summary report provides detailed insights into support ticket activities for the specified period. \n                    The analytics reveal ticket distribution patterns, resolution efficiency, and overall team performance metrics. \n                    Use this data to identify trends, optimize workflows, and enhance customer support excellence.\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"footer\">\n            <p class=\"copyright\">&copy; 2025 Customer Portal. All rights reserved.</p>\n            <p class=\"generated\">Generated on {{ date.now }}</p>\n        </div>\n    </div>\n</body>\n</html>\n"
            ),
            new ReportTemplate(
                _guidGenerator.Create(),
                TemplateType.Report,
                ReportTypes.SupportAgentTicketReport,
                "Support Agent Ticket Report",
                "<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Support Agent Report</title>\n    <style>\n        body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            line-height: 1.6; \n            color: #333; \n            margin: 0; \n            padding: 0; \n            background-color: #f8f9fa;\n        }\n        .container { \n            max-width: 800px; \n            margin: 0 auto; \n            background-color: white; \n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        .header { \n            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); \n            color: white; \n            padding: 30px; \n            text-align: center;\n        }\n        .header h1 { \n            margin: 0; \n            font-size: 28px; \n            font-weight: 300;\n        }\n        .header .subtitle { \n            margin-top: 10px; \n            opacity: 0.9; \n            font-size: 16px;\n        }\n        .content { \n            padding: 30px;\n        }\n        .info-section { \n            background-color: #f8f9fa; \n            padding: 20px; \n            border-radius: 8px; \n            margin-bottom: 25px;\n            border-left: 4px solid #007bff;\n        }\n        .info-grid { \n            display: grid; \n            grid-template-columns: 1fr 1fr; \n            gap: 20px; \n            margin-top: 15px;\n        }\n        .info-item { \n            background-color: white; \n            padding: 15px; \n            border-radius: 6px; \n            border: 1px solid #e9ecef;\n        }\n        .info-item strong { \n            color: #007bff; \n            display: block; \n            margin-bottom: 5px;\n        }\n        .status-resolved { color: #28a745; font-weight: bold; }\n        .status-pending { color: #ffc107; font-weight: bold; }\n        .status-critical { color: #dc3545; font-weight: bold; }\n        .footer { \n            background-color: #6c757d; \n            color: white; \n            padding: 20px; \n            text-align: center; \n            font-size: 14px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>Support Agent Report</h1>\n            <div class=\"subtitle\">Customer Service Summary</div>\n        </div>\n        \n        <div class=\"content\">\n            <div class=\"info-section\">\n                <h2>Support Agent Information</h2>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Agent Name</strong>\n                        {{ SupportAgentName }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Report Date</strong>\n                        {{ date.now }}\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"info-section\">\n                <h2>Ticket Details</h2>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Ticket ID</strong>\n                        #{{ TicketId }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Status</strong>\n                        <span class=\"status-{{ Status }}\">{{ Status }}</span>\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Customer</strong>\n                        {{ CustomerName }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Created Date</strong>\n                        {{ CreatedAt }}\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"info-section\">\n                <h2>Issue Description</h2>\n                <p>{{ IssueDescription }}</p>\n            </div>\n\n            {{ if ResolvedAt }}\n            <div class=\"info-section\">\n                <h2>Resolution Information</h2>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Resolved Date</strong>\n                        {{ ResolvedAt }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Resolution Time</strong>\n                        Resolved\n                    </div>\n                </div>\n            </div>\n            {{ end }}\n        </div>\n        \n        <div class=\"footer\">\n            <p>&copy; 2025 Customer Portal. All rights reserved.</p>\n            <p>Generated on {{ date.now }}</p>\n        </div>\n    </div>\n</body>\n</html>\n"
            ),
            new ReportTemplate(
                _guidGenerator.Create(),
                TemplateType.Report,
                ReportTypes.SupportAgentWithTechnicianReport,
                "Support Agent with Technician Report",
                "<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Support Agent with Technician Report</title>\n    <style>\n        body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            line-height: 1.6; \n            color: #333; \n            margin: 0; \n            padding: 0; \n            background-color: #f8f9fa;\n        }\n        .container { \n            max-width: 800px; \n            margin: 0 auto; \n            background-color: white; \n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        .header { \n            background: linear-gradient(135deg, #6f42c1 0%, #8e44ad 100%); \n            color: white; \n            padding: 30px; \n            text-align: center;\n        }\n        .header h1 { \n            margin: 0; \n            font-size: 28px; \n            font-weight: 300;\n        }\n        .header .subtitle { \n            margin-top: 10px; \n            opacity: 0.9; \n            font-size: 16px;\n        }\n        .content { \n            padding: 30px;\n        }\n        .info-section { \n            background-color: #f8f9fa; \n            padding: 20px; \n            border-radius: 8px; \n            margin-bottom: 25px;\n            border-left: 4px solid #6f42c1;\n        }\n        .team-section {\n            background-color: #f8f9fa; \n            padding: 20px; \n            border-radius: 8px; \n            margin-bottom: 25px;\n            border-left: 4px solid #6f42c1;\n        }\n        .team-grid {\n            display: grid; \n            grid-template-columns: 1fr 1fr; \n            gap: 20px; \n            margin-top: 15px;\n        }\n        .info-grid { \n            display: grid; \n            grid-template-columns: 1fr 1fr; \n            gap: 20px; \n            margin-top: 15px;\n        }\n        .info-item { \n            background-color: white; \n            padding: 15px; \n            border-radius: 6px; \n            border: 1px solid #e9ecef;\n        }\n        .info-item strong { \n            color: #6f42c1; \n            display: block; \n            margin-bottom: 5px;\n        }\n        .status-resolved { color: #28a745; font-weight: bold; }\n        .status-pending { color: #ffc107; font-weight: bold; }\n        .status-critical { color: #dc3545; font-weight: bold; }\n        .footer { \n            background-color: #6c757d; \n            color: white; \n            padding: 20px; \n            text-align: center; \n            font-size: 14px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>Support Agent with Technician Report</h1>\n            <div class=\"subtitle\">Collaborative Service Summary</div>\n        </div>\n        \n        <div class=\"content\">\n            <div class=\"team-section\">\n                <h2>Team Information</h2>\n                <div class=\"team-grid\">\n                    <div class=\"info-item\">\n                        <strong>Support Agent</strong>\n                        {{ SupportAgentName }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Technician</strong>\n                        {{ TechnicianName }}\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"info-section\">\n                <h2>Ticket Details</h2>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Ticket ID</strong>\n                        #{{ TicketId }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Status</strong>\n                        <span class=\"status-{{ Status }}\">{{ Status }}</span>\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Customer</strong>\n                        {{ CustomerName }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Created Date</strong>\n                        {{ CreatedAt }}\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"info-section\">\n                <h2>Issue Description</h2>\n                <p>{{ IssueDescription }}</p>\n            </div>\n\n            {{ if ResolvedAt }}\n            <div class=\"info-section\">\n                <h2>Resolution Information</h2>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Resolved Date</strong>\n                        {{ ResolvedAt }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Resolution Time</strong>\n                        Resolved\n                    </div>\n                </div>\n            </div>\n            {{ end }}\n        </div>\n        \n        <div class=\"footer\">\n            <p>&copy; 2025 Customer Portal. All rights reserved.</p>\n            <p>Generated on {{ date.now }}</p>\n        </div>\n    </div>\n</body>\n</html>\n"
            ),
            new ReportTemplate(
                _guidGenerator.Create(),
                TemplateType.Report,
                ReportTypes.TechnicianReport,
                "Enhanced Technician Report",
                "<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Enhanced Technician Work Report</title>\n    <style>\n        body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            line-height: 1.6; \n            color: #333; \n            margin: 0; \n            padding: 0; \n            background-color: #f8f9fa;\n        }\n        .container { \n            max-width: 800px; \n            margin: 0 auto; \n            background-color: white; \n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        .header { \n            background: linear-gradient(135deg, #28a745 0%, #20c997 100%); \n            color: white; \n            padding: 30px; \n            text-align: center;\n        }\n        .header h1 { \n            margin: 0; \n            font-size: 28px; \n            font-weight: 300;\n        }\n        .header .subtitle { \n            margin-top: 10px; \n            opacity: 0.9; \n            font-size: 16px;\n        }\n        .content { \n            padding: 30px;\n        }\n        .info-section { \n            background-color: #f8f9fa; \n            padding: 20px; \n            border-radius: 8px; \n            margin-bottom: 25px;\n            border-left: 4px solid #28a745;\n        }\n        .issue-section {\n            background-color: #fff3cd; \n            padding: 20px; \n            border-radius: 8px; \n            margin-bottom: 25px;\n            border-left: 4px solid #ffc107;\n        }\n        .work-section {\n            background-color: #d1ecf1; \n            padding: 20px; \n            border-radius: 8px; \n            margin-bottom: 25px;\n            border-left: 4px solid #17a2b8;\n        }\n        .info-grid { \n            display: grid; \n            grid-template-columns: 1fr 1fr; \n            gap: 20px; \n            margin-top: 15px;\n        }\n        .info-item { \n            background-color: white; \n            padding: 15px; \n            border-radius: 6px; \n            border: 1px solid #e9ecef;\n        }\n        .info-item strong { \n            color: #28a745; \n            display: block; \n            margin-bottom: 5px;\n        }\n        .issue-item {\n            background-color: white; \n            padding: 15px; \n            border-radius: 6px; \n            border: 1px solid #ffeaa7;\n            margin-bottom: 10px;\n        }\n        .work-item {\n            background-color: white; \n            padding: 15px; \n            border-radius: 6px; \n            border: 1px solid #bee5eb;\n            margin-bottom: 10px;\n        }\n        .status-resolved { color: #28a745; font-weight: bold; }\n        .status-pending { color: #ffc107; font-weight: bold; }\n        .status-critical { color: #dc3545; font-weight: bold; }\n        .priority-high { color: #dc3545; font-weight: bold; }\n        .priority-medium { color: #ffc107; font-weight: bold; }\n        .priority-low { color: #28a745; font-weight: bold; }\n        .footer { \n            background-color: #6c757d; \n            color: white; \n            padding: 20px; \n            text-align: center; \n            font-size: 14px;\n        }\n        .section-title {\n            color: #28a745;\n            font-size: 18px;\n            font-weight: bold;\n            margin-bottom: 15px;\n            display: flex;\n            align-items: center;\n        }\n        .section-title::before {\n            content: \"üîß\";\n            margin-right: 10px;\n            font-size: 20px;\n        }\n        .issue-title {\n            color: #856404;\n            font-size: 18px;\n            font-weight: bold;\n            margin-bottom: 15px;\n            display: flex;\n            align-items: center;\n        }\n        .issue-title::before {\n            content: \"‚ö†Ô∏è\";\n            margin-right: 10px;\n            font-size: 20px;\n        }\n        .work-title {\n            color: #0c5460;\n            font-size: 18px;\n            font-weight: bold;\n            margin-bottom: 15px;\n            display: flex;\n            align-items: center;\n        }\n        .work-title::before {\n            content: \"‚úÖ\";\n            margin-right: 10px;\n            font-size: 20px;\n        }\n        .ticket-id {\n            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);\n            color: white;\n            padding: 8px 16px;\n            border-radius: 20px;\n            font-weight: bold;\n            display: inline-block;\n            margin-bottom: 10px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>Enhanced Technician Work Report</h1>\n            <div class=\"subtitle\">Professional Service Documentation</div>\n        </div>\n        \n        <div class=\"content\">\n            <!-- Technician Information Section -->\n            <div class=\"info-section\">\n                <div class=\"section-title\">Technician Information</div>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Technician Name</strong>\n                        {{ TechnicianName }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Report Date</strong>\n                        {{ date.now }}\n                    </div>\n                </div>\n            </div>\n\n            <!-- Ticket Details Section -->\n            <div class=\"info-section\">\n                <div class=\"section-title\">Ticket Details</div>\n                <div class=\"ticket-id\">Ticket #{{ TicketId }}</div>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Ticket Subject</strong>\n                        {{ TicketSubject }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Status</strong>\n                        <span class=\"status-{{ Status }}\">{{ Status }}</span>\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Customer</strong>\n                        {{ CustomerName }}\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Priority</strong>\n                        <span class=\"priority-{{ Priority | string.downcase }}\">{{ Priority }}</span>\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Created Date</strong>\n                        {{ CreatedAt }}\n                    </div>\n                    {{ if ResolvedAt }}\n                    <div class=\"info-item\">\n                        <strong>Resolved Date</strong>\n                        {{ ResolvedAt }}\n                    </div>\n                    {{ end }}\n                </div>\n            </div>\n\n            <!-- Issue Description Section -->\n            <div class=\"issue-section\">\n                <div class=\"issue-title\">Issue Description</div>\n                <div class=\"issue-item\">\n                    <strong>Problem Reported:</strong><br>\n                    {{ IssueDescription }}\n                </div>\n            </div>\n\n            <!-- Work Performed Section -->\n            <div class=\"work-section\">\n                <div class=\"work-title\">Work Performed</div>\n                <div class=\"work-item\">\n                    <strong>Technical Work Completed:</strong><br>\n                    {{ WorkPerformed }}\n                </div>\n            </div>\n\n            <!-- Resolution Summary -->\n            {{ if ResolvedAt }}\n            <div class=\"info-section\">\n                <div class=\"section-title\">Resolution Summary</div>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <strong>Resolution Status</strong>\n                        <span class=\"status-resolved\">Resolved</span>\n                    </div>\n                    <div class=\"info-item\">\n                        <strong>Resolution Date</strong>\n                        {{ ResolvedAt }}\n                    </div>\n                </div>\n            </div>\n            {{ end }}\n        </div>\n        \n        <div class=\"footer\">\n            <p>&copy; 2025 Customer Portal. All rights reserved.</p>\n            <p>Generated on {{ date.now }}</p>\n        </div>\n    </div>\n</body>\n</html>\n"
            )
        };

        await _reportTemplateRepository.InsertManyAsync(reportTemplatelist);
    }
}